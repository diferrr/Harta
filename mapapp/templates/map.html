<!DOCTYPE html> <!-- –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∫–∞–∫ HTML5 -->
<html lang="ro"> <!-- –û—Ç–∫—Ä—ã–≤–∞–µ–º HTML-–¥–æ–∫—É–º–µ–Ω—Ç, –∑–∞–¥–∞—ë–º —è–∑—ã–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (—Ä—É–º—ã–Ω—Å–∫–∏–π) -->
<head>
    <meta charset="UTF-8"> <!-- –£–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–¥–∏—Ä–æ–≤–∫—É UTF-8 (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ —Å–∏–º–≤–æ–ª—ã) -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ–¥ –º–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ -->
    <title>Harta Sinoptica</title> <!-- –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫–µ –±—Ä–∞—É–∑–µ—Ä–∞) -->

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º —Å—Ç–∏–ª–∏ –∏ JavaScript –¥–ª—è Leaflet (–∫–∞—Ä—Ç—ã) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" /> <!-- CSS –¥–ª—è Leaflet -->
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script> <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º JavaScript –¥–ª—è Leaflet -->

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Leaflet.markercluster –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤ –≤ –∫–ª–∞—Å—Ç–µ—Ä—ã -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css">
    <script src="https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js"></script>

    <style>
        /* –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
        body {
            font-family: Arial, sans-serif; /* –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —à—Ä–∏—Ñ—Ç */
            text-align: center; /* –í—ã—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Ç–µ–∫—Å—Ç –ø–æ —Ü–µ–Ω—Ç—Ä—É */
            background-color: #f4f4f4; /* –¶–≤–µ—Ç —Ñ–æ–Ω–∞ */
            padding: 20px; /* –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –æ—Ç—Å—Ç—É–ø */
        }

        h1 {
            color: #2c3e50; /* –¶–≤–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞ */
            margin-bottom: 10px; /* –û—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É */
        }

       #map {
    height: 600px; /* –í—ã—Å–æ—Ç–∞ –∫–∞—Ä—Ç—ã */
    width: 1300px; /* –¢–µ–ø–µ—Ä—å —à–∏—Ä–∏–Ω–∞ —Ä–∞–≤–Ω–∞ –≤—ã—Å–æ—Ç–µ, –¥–µ–ª–∞—è –∫–∞—Ä—Ç—É –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–π */
    border: 2px solid #2c3e50; /* –ì—Ä–∞–Ω–∏—Ü–∞ */
    border-radius: 8px; /* –ó–∞–∫—Ä—É–≥–ª—ë–Ω–Ω—ã–µ —É–≥–ª—ã */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* –¢–µ–Ω—å –≤–æ–∫—Ä—É–≥ –∫–∞—Ä—Ç—ã */
    margin: 0 auto; /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –∫–∞—Ä—Ç—É –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ */
}


        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ø–æ–∏—Å–∫–∞ */
        #search-container {
            margin-bottom: 10px; /* –û—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É */
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–ª—è –≤–≤–æ–¥–∞ */
        #search-box {
            padding: 8px; /* –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –æ—Ç—Å—Ç—É–ø */
            width: 250px; /* –®–∏—Ä–∏–Ω–∞ */
            border: 1px solid #ccc; /* –ì—Ä–∞–Ω–∏—Ü–∞ */
            border-radius: 4px; /* –ó–∞–∫—Ä—É–≥–ª—ë–Ω–Ω—ã–µ —É–≥–ª—ã */
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –ø–æ–∏—Å–∫–∞ */
        #search-button {
            padding: 8px 15px; /* –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ—Ç—Å—Ç—É–ø—ã */
            background-color: #2c3e50; /* –¶–≤–µ—Ç —Ñ–æ–Ω–∞ */
            color: white; /* –¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ */
            border: none; /* –£–±–∏—Ä–∞–µ–º –≥—Ä–∞–Ω–∏—Ü—É */
            border-radius: 4px; /* –ó–∞–∫—Ä—É–≥–ª—ë–Ω–Ω—ã–µ —É–≥–ª—ã */
            cursor: pointer; /* –ò–∑–º–µ–Ω—è–µ–º –∫—É—Ä—Å–æ—Ä –Ω–∞ —É–∫–∞–∑–∞—Ç–µ–ª—å */
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –≤—Å–ø–ª—ã–≤–∞—é—â–µ–≥–æ –æ–∫–Ω–∞ (popup) */
        .leaflet-popup-content {
            font-size: 14px; /* –†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ */
            color: #2c3e50; /* –¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ */
            text-align: center; /* –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ —Ü–µ–Ω—Ç—Ä—É */
            padding: 10px; /* –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –æ—Ç—Å—Ç—É–ø */
        }

        .leaflet-popup-content b {
            font-size: 16px; /* –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π —à—Ä–∏—Ñ—Ç */
            color: #e74c3c; /* –ö—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç */
        }

        .leaflet-popup-content a {
            color: #3498db; /* –ì–æ–ª—É–±–æ–π —Ü–≤–µ—Ç —Å—Å—ã–ª–∫–∏ */
            font-weight: bold; /* –ñ–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç */
            text-decoration: none; /* –£–±–∏—Ä–∞–µ–º –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–Ω–∏–µ */
        }

        .leaflet-popup-content a:hover {
            text-decoration: underline; /* –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–Ω–∏–µ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
        }

        .leaflet-popup-tip {
            background: #2c3e50; /* –¶–≤–µ—Ç "—Ö–≤–æ—Å—Ç–∏–∫–∞" –≤—Å–ø–ª—ã–≤–∞—é—â–µ–≥–æ –æ–∫–Ω–∞ */
        }
    </style>
</head>
<body>

    <h1>Harta Sinoptica</h1> <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->

    <div id="search-container"> <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –ø–æ–∏—Å–∫–∞ -->
        <input type="text" id="search-box" placeholder="√Æntroduce»õi Nr obiectului..."> <!-- –ü–æ–ª–µ –≤–≤–æ–¥–∞ –Ω–æ–º–µ—Ä–∞ –æ–±—ä–µ–∫—Ç–∞ -->
        <button id="search-button">CAUTƒÇ</button> <!-- –ö–Ω–æ–ø–∫–∞ –ø–æ–∏—Å–∫–∞ -->
    </div>

    <div id="map"></div> <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–∞—Ä—Ç—ã -->

    <script>
    // –°–æ–∑–¥–∞—ë–º –∫–∞—Ä—Ç—É Leaflet –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–π –≤–∏–¥
    var map = L.map('map').setView([47.0569, 28.857], 12);

    // –î–æ–±–∞–≤–ª—è–µ–º —Å–ª–æ–π –∫–∞—Ä—Ç—ã OpenStreetMap
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '¬© OpenStreetMap contributors'
    }).addTo(map);

    var markers = L.markerClusterGroup(); // –ì—Ä—É–ø–ø–∞ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –º–∞—Ä–∫–µ—Ä–æ–≤
    var pumpMarkers = {}; // –û–±—ä–µ–∫—Ç –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤

    // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Å —Å–µ—Ä–≤–µ—Ä–∞ (API) –∏ –¥–æ–±–∞–≤–ª—è–µ–º –º–∞—Ä–∫–µ—Ä—ã
    fetch('/api/pumps/')
        .then(response => response.json()) // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç –≤ JSON
        .then(data => {
            data.forEach(pump => { // –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –∫–∞–∂–¥—ã–π –Ω–∞—Å–æ—Å
                let iconUrl = pump.type_device === 1
                    ? '/static/icons/red.png' // –ö—Ä–∞—Å–Ω–∞—è –∏–∫–æ–Ω–∫–∞ –¥–ª—è —Ç–∏–ø–∞ 1
                    : '/static/icons/blue.png'; // –°–∏–Ω—è—è –∏–∫–æ–Ω–∫–∞ –¥–ª—è –¥—Ä—É–≥–∏—Ö

                let marker = L.marker([pump.lat, pump.longitude], { // –°–æ–∑–¥–∞—ë–º –º–∞—Ä–∫–µ—Ä
                    icon: L.icon({
                        iconUrl: iconUrl, // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–∫–æ–Ω–∫—É
                        iconSize: [50, 50], // –†–∞–∑–º–µ—Ä –∏–∫–æ–Ω–∫–∏
                        iconAnchor: [17, 45], // –¢–æ—á–∫–∞ –ø—Ä–∏–≤—è–∑–∫–∏ –∏–∫–æ–Ω–∫–∏
                        popupAnchor: [0, -40] // –°–º–µ—â–µ–Ω–∏–µ –≤—Å–ø–ª—ã–≤–∞—é—â–µ–≥–æ –æ–∫–Ω–∞
                    })
                }).bindPopup(` <!-- –í—Å–ø–ª—ã–≤–∞—é—â–µ–µ –æ–∫–Ω–æ -->
                    <div class="popup-content">
                        <b>${pump.param_name}</b><br> <!-- –ù–∞–∑–≤–∞–Ω–∏–µ –Ω–∞—Å–æ—Å–∞ -->
                        üìç ${pump.address}<br> <!-- –ê–¥—Ä–µ—Å -->
                        <a href='http://10.1.1.174/view/view_page.php?title=${pump.param_name.replace(/\./g, '').replace('PT_', '')}' target='_blank'>üîç –û—Ç–∫—Ä—ã—Ç—å —Å—Ö–µ–º—É</a>
                    </div>
                `);

                markers.addLayer(marker); // –î–æ–±–∞–≤–ª—è–µ–º –º–∞—Ä–∫–µ—Ä –≤ –∫–ª–∞—Å—Ç–µ—Ä
                pumpMarkers[pump.param_name] = marker; // –°–æ—Ö—Ä–∞–Ω—è–µ–º –º–∞—Ä–∫–µ—Ä –≤ –æ–±—ä–µ–∫—Ç–µ
            });

            map.addLayer(markers); // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Ç–µ—Ä—ã –Ω–∞ –∫–∞—Ä—Ç—É
        });

    // –§—É–Ω–∫—Ü–∏—è –ø–æ–∏—Å–∫–∞ –æ–±—ä–µ–∫—Ç–∞
    function searchObject() {
        var query = document.getElementById('search-box').value.trim(); // –ü–æ–ª—É—á–∞–µ–º –≤–≤–µ–¥—ë–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
        if (pumpMarkers[query]) { // –ï—Å–ª–∏ –æ–±—ä–µ–∫—Ç –Ω–∞–π–¥–µ–Ω
            map.setView(pumpMarkers[query].getLatLng(), 16, { animate: true }); // –ü–µ—Ä–µ–º–µ—â–∞–µ–º –∫–∞—Ä—Ç—É

            map.once('moveend', function() { // –ñ–¥—ë–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è
                pumpMarkers[query].openPopup(); // –û—Ç–∫—Ä—ã–≤–∞–µ–º –≤—Å–ø–ª—ã–≤–∞—é—â–µ–µ –æ–∫–Ω–æ
            });

        } else {
            alert('Obiectul nu a fost gƒÉsit!'); // –í—ã–≤–æ–¥–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ, –µ—Å–ª–∏ –æ–±—ä–µ–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω
        }
    }

    // –ü–æ–∏—Å–∫ –ø–æ –∫–Ω–æ–ø–∫–µ
    document.getElementById('search-button').addEventListener('click', searchObject);

    // –ü–æ–∏—Å–∫ –ø–æ –∫–ª–∞–≤–∏—à–µ Enter
    document.getElementById('search-box').addEventListener('keyup', function(event) {
        if (event.key === 'Enter') {
            searchObject();
        }
    });
    </script>
</body>
</html>


